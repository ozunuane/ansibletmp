---

- name: setup webserver
  hosts: webservers
  become: yes
  tasks:
    
    - name: get python-apt
      apt:
        name: python-apt
        state: present  
      when: ansible_os_family == "Ubuntu"


    - name: Run the equivalent of "apt-get update" as a separate step
      apt:
         update_cache: yes
      when: ansible_os_family == "Ubuntu"
 
   

    - name: install the latest version of Apache on Centos 
      yum:
        name: httpd
        state: latest
        update_cache: yes
      when: ansible_os_family == "CentOS"
     
    - name: Install apache service on Ubuntu avoid starting it immediately
      apt:
        name: Apache 
        state: latest
      environment:
        RUNLEVLEL: 1  

      when: ansible_os_family == "Ubuntu"
    
 

    - name: Start service httpd, if not running 
      service:
        name: httpd
        state: started
        enable: yes
      when: ansible_os_family == "CentOS"
        
     

    - name: example copying file with owner and permissions
      copy:
        src: /home/ubuntu/vprofile/exc1/website/webpage/
        dest: /var/www/html/
        owner: root
        group: root
        mode: 0644


    - name: Restart service httpd, in all cases
      service:
        name: httpd
        state: restarted
      when: ansible_os_family == "CentOS"



